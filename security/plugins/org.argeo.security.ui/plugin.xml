<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <!-- Security -->
   <extension
         id="defaultLoginDialog"
         name="Default Login Dialog"
         point="org.eclipse.equinox.security.callbackHandler">
      <callbackHandler
            class="org.argeo.security.ui.dialogs.DefaultLoginDialog">
      </callbackHandler>
   </extension>
   <extension point="org.eclipse.ui.services">
        <sourceProvider
              provider="org.argeo.security.ui.RolesSourceProvider">
           <variable
                 name="org.argeo.security.ui.rolesVariable"
                 priorityLevel="workbench">
           </variable>
        </sourceProvider>
     </extension>
   <extension
         point="org.eclipse.ui.views">
      <view
            id="org.argeo.security.ui.userProfile"
            class="org.argeo.security.ui.views.UserProfile"
            icon="icons/user.gif"
            name="Profile"
            restorable="true">
      </view>
      <view
            id="org.argeo.security.ui.logView"
            class="org.argeo.eclipse.spring.SpringExtensionFactory"
            name="Log"
            icon="icons/log.gif"
            restorable="false">
      </view>
      <view
            id="org.argeo.security.ui.adminLogView"
            class="org.argeo.eclipse.spring.SpringExtensionFactory"
            name="Admin Log"
            icon="icons/adminLog.gif"
            restorable="false">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.perspectives">
      <perspective
            class="org.argeo.security.ui.UserHomePerspective"
            icon="icons/home.gif"
            id="org.argeo.security.ui.userHomePerspective"
            name="Home">
      </perspective>
      <perspective
            class="org.argeo.security.ui.MaintenancePerspective"
            icon="icons/maintenance.gif"
            id="org.argeo.security.ui.adminMaintenancePerspective"
            name="Maintenance">
      </perspective>
   </extension>
  <extension
           point="org.eclipse.ui.activities">
        <activity
              description="Only for admins"
              id="org.argeo.security.ui.adminActivity"
              name="Admin">
		  <enabledWhen>
		    <with variable="roles">
		      <iterate ifEmpty="false" operator="or">
		        <equals value="ROLE_ADMIN" />
		      </iterate>
		    </with>
		  </enabledWhen>
        </activity>
        <activityPatternBinding
              activityId="org.argeo.security.ui.adminActivity"
              isEqualityPattern="true"
              pattern="org.argeo.security.ui/org.argeo.security.ui.adminMaintenancePerspective">
        </activityPatternBinding>
        <activityPatternBinding
              activityId="org.argeo.security.ui.adminActivity"
              isEqualityPattern="true"
              pattern="org.argeo.security.ui/org.argeo.security.ui.adminLogView">
        </activityPatternBinding>
     </extension>
 </plugin>
